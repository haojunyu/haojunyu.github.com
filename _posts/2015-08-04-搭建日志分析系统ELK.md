---
layout:	default
title:	快速部署日志分析系统ELK
category:	ubuntu
comments:	true
---
日志分析系统ELK是三个开源软件的缩写，分别是Elasticsearch，Logstash，Kibana。其中Elasticsearch是用来实现索引和搜索功能的目的，Logstash是一个很灵活的日志收集和处理工具。Kibana是和Elasticsearch配套的图形展示界面，用于方便的展示数据和分析数据。本文对整个套件的安装配置过程作了记录，并写了一键安装配置的脚本。


## 环境信息
* 操作系统 Ubuntu 14.04 64bit
* 依赖环境 
	1. java环境
	
		```bash
		sudo apt-get install openjdk-7-jdk
		```
	2. redis[==单机时不用安装,CS模式中充当缓存队列==]

		```bash
		sudo apt-get install redis-server
		```

## Elasticsearch安装与配置
1. 导入GPG key
	
	```bash
	wget -O - http://packages.elasticsearch.org/GPG-KEY-elasticsearch | sudo apt-key add -
	```
2. 添加elasticsearch到源（source list）中

	```bash
	echo 'deb http://packages.elasticsearch.org/elasticsearch/1.4/debian stable main' | sudo tee /etc/apt/sources.list.d/elasticsearch.list
	```
3. 更新软件包数据库

	```bash
	sudo apt-get update
	```
4. 安装elasticsearch

	```bash
	sudo apt-get -y install elasticsearch=1.4.4
	```
5. 配置elasticsearch[/etc/elasticsearch/elasticsearch.yml]
	....

6. 启动elasticsearch服务

	```bash
	sudo service elasticsearch restart
	```
7. 设置elasticsearch开机启动

	```bash
	sudo update-rc.d elasticsearch defaults 95 10
	```

## Logstash的安装和配置
1. 添加logstash到源中
	
	```bash
	echo 'deb http://packages.elasticsearch.org/logstash/1.5/debian stable main' | sudo tee /etc/apt/sources.list.d/logstash.list
	```
2. 更新软件包数据库

	```bash
	sudo apt-get update
	```
3. 安装logstash

	```bash
	sudo apt-get install logstash
	```
4. 配置logstash[向/etc/logstash/conf.d/文件夹中添加配置文件]

	```bash
	# 单机配置
	sudo cp ./single.conf /etc/logstash/conf.d
	# 服务端配置
	sudo cp ./center.conf /etc/logstach/conf.d
	# 客户端配置
	sudo cp ./shipper.conf /etc/logstash/conf.d
	```
5. 启动logstash服务

	```bash
	sudo service logstash restart
	```
6. 设置logstash开机启动，比elasticsearch启动快，关闭慢

	```bash
	sudo update-rc.d logstash defaults 94 11
	```
	
## 安装k


 
